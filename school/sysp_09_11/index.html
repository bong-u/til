<!doctype html><html lang=ko>
<head>
<title>221207 SYSP</title>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="09-process1 ì˜ˆì™¸ì ì¸ ì œì–´ íë¦„  í•˜ìœ„ ë§¤ì»¤ë‹ˆì¦˜  ì˜ˆì™¸ (Exception)   ìƒìœ„ ë§¤ì»¤ë‹ˆì¦˜  í”„ë¡œì„¸ìŠ¤ ì»¨í…ìŠ¤íŠ¸ ì „í™˜  OS ì†Œí”„íŠ¸ì›¨ì–´ì™€ í•˜ë“œì›¨ì–´ íƒ€ì´ë¨¸ë¡œ êµ¬í˜„   ì‹œê·¸ â€¦">
<meta property="og:site_name" content="bong-u/til">
<meta property="og:title" content="221207 SYSP">
<meta property="og:description" content="09-process1 ì˜ˆì™¸ì ì¸ ì œì–´ íë¦„  í•˜ìœ„ ë§¤ì»¤ë‹ˆì¦˜  ì˜ˆì™¸ (Exception)   ìƒìœ„ ë§¤ì»¤ë‹ˆì¦˜  í”„ë¡œì„¸ìŠ¤ ì»¨í…ìŠ¤íŠ¸ ì „í™˜  OS ì†Œí”„íŠ¸ì›¨ì–´ì™€ í•˜ë“œì›¨ì–´ íƒ€ì´ë¨¸ë¡œ êµ¬í˜„   ì‹œê·¸ â€¦">
<meta property="og:type" content="blog">
<meta property="og:url" content="https://github.com/bong-u/til-hugo">
<meta property="og:image" content="https://bong-u.github.io/til/asset/thumbnail.jpg">
<script type=text/javascript src=https://bong-u.github.io/til/script/base.js></script>
<link rel=icon href=https://bong-u.github.io/til/favicon16.png sizes=16x16>
<link rel=icon href=https://bong-u.github.io/til/favicon32.png sizes=32x32>
<link rel=icon href=https://bong-u.github.io/til/favicon48.png sizes=48x48>
<link rel=icon href=https://bong-u.github.io/til/favicon64.png sizes=64x64>
<link id=twCSS rel=stylesheet href=https://bong-u.github.io/til/css/style.css>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-HE9FQR1ML7"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-HE9FQR1ML7')</script>
</head>
<body class=custom-scroll>
<div class="flex w-full flex-col items-center">
<script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js></script>
<script>MathJax={tex:{inlineMath:[['$','$']]}}</script>
<script type=text/javascript src=https://bong-u.github.io/til/script/single.js></script>
<script type=text/javascript src=https://bong-u.github.io/til/script/toc.js></script>
<header class="flex justify-center p-3 w-full text-lg border-b border-line">
<div class="w-full flex justify-between lg-5/6">
<h3>
<a href=https://bong-u.github.io/til/ class=hover-black>
bong-u/til
</a>
</h3>
<div class="flex gap-5">
<a class=hover-black href=https://bong-u.github.io/til/>
ğŸ  home
</a>
<a class=hover-black href=https://github.com/bong-u/til>
ğŸˆ repository
</a>
</div>
</div>
</header>
<input type=checkbox id=toggleDarkMode onchange=toggleDarkModeHandler() hidden>
<main class="w-full lg:w-5/6 px-3 sm:px-12">
<aside class="fixed top-0 right-0 my-24 w-1/6 gap-3 px-9 hidden xl:flex text-sm overflow-hidden">
<nav id=TableOfContents>
<ul>
<li><a href=#09-process1>09-process1</a>
<ul>
<li><a href=#ì˜ˆì™¸ì ì¸-ì œì–´-íë¦„>ì˜ˆì™¸ì ì¸ ì œì–´ íë¦„</a></li>
<li><a href=#ì˜ˆì™¸-í…Œì´ë¸”-exception-tables>ì˜ˆì™¸ í…Œì´ë¸” (Exception Tables)</a></li>
<li><a href=#ë¹„ë™ê¸°í˜•-ì˜ˆì™¸-interrupt>ë¹„ë™ê¸°í˜• ì˜ˆì™¸ (Interrupt)</a></li>
<li><a href=#ë™ê¸°í˜•-ì˜ˆì™¸>ë™ê¸°í˜• ì˜ˆì™¸</a></li>
<li><a href=#page-fault>Page Fault</a></li>
<li><a href=#process>Process</a></li>
<li><a href=#multiprocessing-ê³¼ê±°>Multiprocessing (ê³¼ê±°)</a></li>
<li><a href=#multiprocessing-í˜„ëŒ€>Multiprocessing (í˜„ëŒ€)</a></li>
<li><a href=#ë™ì‹œì„±-í”„ë¡œì„¸ìŠ¤>ë™ì‹œì„± í”„ë¡œì„¸ìŠ¤</a></li>
<li><a href=#fork>fork</a></li>
<li><a href=#exit>exit</a></li>
<li><a href=#ì¢€ë¹„-zombies>ì¢€ë¹„ (Zombies)</a></li>
</ul>
</li>
<li><a href=#10-process2>10-process2</a>
<ul>
<li><a href=#wait>wait</a></li>
<li><a href=#waitpid>waitpid</a></li>
<li><a href=#sleep>sleep</a></li>
<li><a href=#execve>execve</a></li>
<li><a href=#shell>shell</a></li>
<li><a href=#eval>eval</a></li>
</ul>
</li>
<li><a href=#11-signal>11-signal</a>
<ul>
<li><a href=#signal>Signal</a></li>
<li><a href=#receiving-a-signal>Receiving a signal</a></li>
<li><a href=#ì‹œê·¸ë„ì˜-íŠ¹ì§•>ì‹œê·¸ë„ì˜ íŠ¹ì§•</a></li>
<li><a href=#í”„ë¡œì„¸ìŠ¤-ê·¸ë£¹>í”„ë¡œì„¸ìŠ¤ ê·¸ë£¹</a></li>
<li><a href=#kill>kill</a></li>
<li><a href=#í‚¤ë³´ë“œë¡œë¶€í„°-ì‹œê·¸ë„-ë³´ë‚´ê¸°>í‚¤ë³´ë“œë¡œë¶€í„° ì‹œê·¸ë„ ë³´ë‚´ê¸°</a></li>
<li><a href=#ì‹œê·¸ë„-ë°›ê¸°>ì‹œê·¸ë„ ë°›ê¸°</a></li>
<li><a href=#ì‹œê·¸ë„-í•¸ë“¤ëŸ¬ì˜-ì„¤ì¹˜>ì‹œê·¸ë„ í•¸ë“¤ëŸ¬ì˜ ì„¤ì¹˜</a></li>
<li><a href=#ì‹œê·¸ë„-ë¸”ë¡í•˜ê¸°ì™€-í•´ì œí•˜ê¸°>ì‹œê·¸ë„ ë¸”ë¡í•˜ê¸°ì™€ í•´ì œí•˜ê¸°</a></li>
<li><a href=#ê²½ì£¼-race-í˜„ìƒìœ¼ë¡œ-ì¸í•œ-ë™ê¸°í™”ì˜-ë¬¸ì œ>ê²½ì£¼ Race í˜„ìƒìœ¼ë¡œ ì¸í•œ ë™ê¸°í™”ì˜ ë¬¸ì œ</a></li>
<li><a href=#ê²½ì£¼í˜„ìƒì„-íšŒí”¼í•˜ëŠ”-ë™ê¸°í™”-ë°©ë²•>ê²½ì£¼í˜„ìƒì„ íšŒí”¼í•˜ëŠ” ë™ê¸°í™” ë°©ë²•</a></li>
<li><a href=#ëª…ì‹œì ìœ¼ë¡œ-í•¸ë“¤ëŸ¬ë¥¼-ê¸°ë‹¤ë¦¬ëŠ”-ë°©ì‹>ëª…ì‹œì ìœ¼ë¡œ í•¸ë“¤ëŸ¬ë¥¼ ê¸°ë‹¤ë¦¬ëŠ” ë°©ì‹</a></li>
</ul>
</li>
</ul>
</nav>
</aside>
<section class="my-16 xl:w-5/6">
<div class="mb-8 whitespace-nowrap">
<div class="flex justify-between items-baseline my-4 gap-8">
<h1 id=title class="overflow-ellipsis-bundle text-3xl font-bold p-1">
221207 SYSP
</h1>
</div>
</div>
<div class="text-sm flex mb-8 justify-between text-textgray">
<div>
<span class="text-md mr-1">ğŸ·ï¸ cs</span>
<span class="text-md mr-1">ğŸ·ï¸ c</span>
</div>
<h4 id=date>ìˆ˜ì •ì¼ : 2024-11-15</h4>
</div>
<hr class=opacity-30>
<article data-pagefind-body id=content class="bg-inherit markdown-body flex flex-col">
<h2 id=09-process1>09-process1</h2>
<h3 id=ì˜ˆì™¸ì ì¸-ì œì–´-íë¦„>ì˜ˆì™¸ì ì¸ ì œì–´ íë¦„</h3>
<ul>
<li>í•˜ìœ„ ë§¤ì»¤ë‹ˆì¦˜
<ol>
<li>ì˜ˆì™¸ (Exception)</li>
</ol>
</li>
<li>ìƒìœ„ ë§¤ì»¤ë‹ˆì¦˜
<ol>
<li>í”„ë¡œì„¸ìŠ¤ ì»¨í…ìŠ¤íŠ¸ ì „í™˜
<ul>
<li>OS ì†Œí”„íŠ¸ì›¨ì–´ì™€ í•˜ë“œì›¨ì–´ íƒ€ì´ë¨¸ë¡œ êµ¬í˜„</li>
</ul>
</li>
<li>ì‹œê·¸ë„
<ul>
<li>OS ì†Œí”„íŠ¸ì›¨ì–´ë¡œ êµ¬í˜„</li>
</ul>
</li>
<li>nolocal ì í”„</li>
</ol>
</li>
</ul>
<h3 id=ì˜ˆì™¸-í…Œì´ë¸”-exception-tables>ì˜ˆì™¸ í…Œì´ë¸” (Exception Tables)</h3>
<ul>
<li>ê° ì´ë²¤íŠ¸ íƒ€ì…ì€ ì˜ˆì™¸ë²ˆí˜¸ kë¥¼ ê°–ëŠ”ë‹¤</li>
</ul>
<h3 id=ë¹„ë™ê¸°í˜•-ì˜ˆì™¸-interrupt>ë¹„ë™ê¸°í˜• ì˜ˆì™¸ (Interrupt)</h3>
<ul>
<li>
<p>ì…ì¶œë ¥ ì¸í„°ëŸ½íŠ¸ (ctrl + c)</p>
</li>
<li>
<p>í•˜ë“œ ë¦¬ì…‹ ì¸í„°ëŸ¬íŠ¸</p>
</li>
<li>
<p>ì†Œí”„íŠ¸ ë¦¬ì…‹ ì¸í„°ëŸ½íŠ¸</p>
<h3 id=ë™ê¸°í˜•-ì˜ˆì™¸>ë™ê¸°í˜• ì˜ˆì™¸</h3>
</li>
<li>
<p>Traps : ëª…ë ¹ì–´ì˜ ê²°ê³¼ë¡œ ë°œìƒí•˜ëŠ” ì˜ë„ì ì¸ ì˜ˆì™¸ (syscall)</p>
</li>
<li>
<p>Faults : í•¸ë“¤ëŸ¬ê°€ ì •ì •í•  ìˆ˜ ìˆëŠ” ì—ëŸ¬ì˜ ê²°ê³¼ë¡œ ë°œìƒ (page faults)</p>
</li>
<li>
<p>Aborts : ë³µêµ¬ ë¶ˆê°€ëŠ¥í•œ ì—ëŸ¬ì˜ ê²°ê³¼ë¡œ ë°œìƒ</p>
</li>
</ul>
<h3 id=page-fault>Page Fault</h3>
<ul>
<li>
<p>ì‚¬ìš©ì ë©”ëª¨ë¦¬ì˜ íŠ¹ì • í˜ì´ì§€ê°€ í˜„ì¬ í•˜ë“œë””ìŠ¤í¬ì— ìœ„ì¹˜í•˜ëŠ” ê²½ìš°</p>
</li>
<li>
<p>ì˜¤ë¥˜ ì²˜ë¦¬í›„ì— ì˜¤ë¥˜ë¥¼ ë°œìƒì‹œí‚¨ ëª…ë ¹ì–´ë¥¼ ë‹¤ì‹œ ì‹¤í–‰í•œë‹¤</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span style=color:#66d9ef>int</span> a [<span style=color:#ae81ff>1000</span>];
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span> () {
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span>a[<span style=color:#ae81ff>500</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>13</span>;
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span>}
</code></pre></div><h3 id=process>Process</h3>
<blockquote>
<p>í”„ë¡œì„¸ìŠ¤ : ìš´ì˜ì²´ì œê°€ ë§Œë“¤ì–´ ì£¼ëŠ” í”„ë¡œê·¸ë¨ì˜ í•œ ì‹¤í–‰ ì˜ˆ</p>
</blockquote>
</li>
<li>
<p>í”„ë¡œê·¸ë¨ì— 2ê°œì˜ ì¤‘ìš”í•œ ì¶”ìƒí™” ì œê³µ</p>
<ol>
<li>ë…¼ë¦¬ì ì¸ ì œì–´ íë¦„ : ê° í”„ë¡œê·¸ë¨ì´ CPUë¥¼ ë…ì í•˜ëŠ” ê²ƒì²˜ëŸ¼ ë³´ì´ê²Œ í•œë‹¤</li>
<li>ì‚¬ì ì¸ ì£¼ì†Œ ê³µê°„ : ê° í”„ë¡œê·¸ë¨ì´ ì£¼ ë©”ëª¨ë¦¬ë¥¼ ë…ì í•˜ëŠ” ê²ƒ ì²˜ëŸ¼ ë³´ì´ë„ë¡ í•œë‹¤</li>
</ol>
</li>
<li>
<p>ì–´ë–»ê²Œ?</p>
<ol>
<li>í”„ë¡œì„¸ìŠ¤ì˜ ì‹¤í–‰ì´ ì„œë¡œ êµëŒ€ë¡œ ì‹¤í–‰ëœë‹¤</li>
<li>ì£¼ì†Œê³µê°„ì˜ ê°€ìƒë©”ëª¨ë¦¬ ì‹œìŠ¤í…œì— ì˜í•´ ê´€ë¦¬</li>
</ol>
</li>
</ul>
<h3 id=multiprocessing-ê³¼ê±°>Multiprocessing (ê³¼ê±°)</h3>
<ol>
<li>
<p>í˜„ì¬ ë ˆì§€ìŠ¤í„°ë“¤ì„ ë©”ëª¨ë¦¬ì— ë³´ê´€</p>
</li>
<li>
<p>ë‹¤ìŒ í”„ë¡œì„¸ìŠ¤ë¥¼ ì‹¤í–‰í•˜ê¸° ìœ„í•´ ìŠ¤ì¼€ì¥´ë§</p>
</li>
<li>
<p>ë³´ê´€ëœ ë ˆì§€ìŠ¤í„°ë“¤ì„ ê°€ì ¸ì˜¤ê³  ì£¼ì†Œê³µê°„ì„ ì „í™˜ (context switch)</p>
<h3 id=multiprocessing-í˜„ëŒ€>Multiprocessing (í˜„ëŒ€)</h3>
</li>
<li>
<p>ë©€í‹°ì½”ì–´ í”„ë¡œì„¸ì„œ</p>
</li>
<li>
<p>ê° ì½”ì–´ëŠ” ë³„ë„ì˜ í”„ë¡œì„¸ìŠ¤ë¥¼ ì‹¤í–‰ ê°€ëŠ¥</p>
</li>
</ol>
<h3 id=ë™ì‹œì„±-í”„ë¡œì„¸ìŠ¤>ë™ì‹œì„± í”„ë¡œì„¸ìŠ¤</h3>
<ol>
<li>ë‘ í”„ë¡œì„¸ìŠ¤ì˜ ì‹¤í–‰ì‹œê°„ì´ ì„œë¡œ ì¤‘ì²©ë˜ë©´ -> concurrent</li>
<li>ì¤‘ì²©ë˜ì§€ ì•Šê³  ìˆœì°¨ì ìœ¼ë¡œ ì‹¤í–‰ëœë‹¤ë©´ -> sequential</li>
</ol>
<h3 id=fork>fork</h3>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span style=color:#66d9ef>int</span> fork(<span style=color:#66d9ef>void</span>)
</code></pre></div><ul>
<li>í˜¸ì¶œí•˜ëŠ” í”„ë¡œì„¸ìŠ¤ì™€ ë™ì¼í•œ ìƒˆ í”„ë¡œì„¸ìŠ¤ ìƒì„±</li>
<li>ìì‹ í”„ë¡œì„¸ìŠ¤ëŠ” 0ì„ ë¦¬í„´</li>
<li>ë¶€ëª¨ í”„ë¡œì„¸ìŠ¤ëŠ” ìì‹ í”„ë¡œì„¸ìŠ¤ì˜ pid ë¦¬í„´</li>
</ul>
<h3 id=exit>exit</h3>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span style=color:#66d9ef>void</span> exit(<span style=color:#66d9ef>int</span> status)
</code></pre></div><ul>
<li>ì¢…ë£Œ ìƒíƒœ status ê°’ì„ ê°€ì§€ê³  ì¢…ë£Œ (ì •ìƒì´ë©´ 0)</li>
<li>atexit() í•¨ìˆ˜ëŠ” exit í•  ë•Œ ì‹¤í–‰í•  í•¨ìˆ˜ë¥¼ ë“±ë¡</li>
</ul>
<h3 id=ì¢€ë¹„-zombies>ì¢€ë¹„ (Zombies)</h3>
<ul>
<li>
<p>ì¢…ë£Œë˜ì—ˆì§€ë§Œ, ì•„ì§ ì •ë¦¬ë˜ì§€ ì•Šì€ í”„ë¡œì„¸ìŠ¤</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>fork8</span>() {
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span style=color:#66d9ef>if</span> (fork() <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>) {
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span>  printf(<span style=color:#e6db74>&#34;Running child, PID = %d</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>, getpid());
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span>  <span style=color:#66d9ef>while</span> (<span style=color:#ae81ff>1</span>)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span>    ;
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span>}
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span style=color:#66d9ef>else</span> {
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span>  printf(<span style=color:#e6db74>&#34;Terminating Parent, PID = %d</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>, getpid());
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span>  exit(<span style=color:#ae81ff>0</span>);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span>}
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span>}
</code></pre></div></li>
</ul>
<h2 id=10-process2>10-process2</h2>
<h3 id=wait>wait</h3>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span style=color:#66d9ef>int</span> wait (<span style=color:#66d9ef>int</span> <span style=color:#f92672>*</span>child_status)
</code></pre></div><ul>
<li>
<p>í˜„ì¬ í”„ë¡œì„¸ìŠ¤ë¥¼ ìì‹ ì˜ ìì‹ í”„ë¡œì„¸ìŠ¤ë“¤ ì¤‘ì— í•˜ë‚˜ê°€ ì¢…ë£Œë  ë•Œê¹Œì§€ ì •ì§€ì‹œí‚¨ë‹¤</p>
</li>
<li>
<p>ë¦¬í„´ê°’ì€ ì¢…ë£Œí•œ ìì‹ í”„ë¡œì„¸ìŠ¤ì˜ PID</p>
</li>
<li>
<p>child_status != NULLì¸ ê²½ìš°, ìì‹ í”„ë¡œê·¸ë¨ì˜ ì¢…ë£Œ ì´ìœ ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ìƒíƒœì •ë³´ë¥¼ ê°–ëŠ”ë‹¤</p>
</li>
<li>
<p>example</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span>pid_t wpid <span style=color:#f92672>=</span> wait(<span style=color:#f92672>&amp;</span>child_status);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span style=color:#66d9ef>if</span> (WIFEXITED(child_status))
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span>  printf(<span style=color:#e6db74>&#34;Child %d terminated with exit status %d</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>, wpid, WEXITSTATUS(child_status));
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span style=color:#66d9ef>else</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span>  <span style=color:#a6e22e>printf</span>(<span style=color:#e6db74>&#34;Child %d terminate abnormally</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>, wpid);
</code></pre></div><h3 id=waitpid>waitpid</h3>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span>waitpid(pid, <span style=color:#f92672>&amp;</span>status, options)
</code></pre></div></li>
<li>
<p>pid : íŠ¹ì • pidì˜ í”„ë¡œì„¸ìŠ¤ë¥¼ ê¸°ë‹¤ë¦°ë‹¤. -1ì´ë©´ wait()ê³¼ ë™ì¼</p>
</li>
<li>
<p>options : 0 (ì¢…ë£Œëœ ìì‹ì„ ê¸°ë‹¤ë¦°ë‹¤), WNOHANG(==1 í•œë²ˆë§Œ ì²´í¬), WUNTRACED(==2, ì •ì§€ë˜ê±°ë‚˜ ì¢…ë£Œëœ ìì‹ì„ ê¸°ë‹¤ë¦°ë‹¤)</p>
<h3 id=sleep>sleep</h3>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span style=color:#75715e>// ìê¸° ìì‹ ì„ secsì´ˆ ë™ì•ˆ ì •ì§€
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span style=color:#75715e></span><span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>int</span> sleep(<span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>int</span> secs)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span style=color:#75715e>// í˜¸ì¶œí•˜ëŠ” í”„ë¡œì„¸ìŠ¤ë¥¼ ì‹œê·¸ë„ ë°›ì„ ë•Œ ê¹Œì§€ ì ì¬ìš´ë‹¤
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span style=color:#75715e></span><span style=color:#66d9ef>int</span> pause(<span style=color:#66d9ef>void</span>)
</code></pre></div><h3 id=execve>execve</h3>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span style=color:#66d9ef>int</span> execve(<span style=color:#66d9ef>char</span> <span style=color:#f92672>*</span>filename, <span style=color:#66d9ef>char</span> <span style=color:#f92672>*</span>argv[], <span style=color:#66d9ef>char</span> <span style=color:#f92672>*</span>envp[])
</code></pre></div></li>
<li>
<p>ì‹¤í–‰ íŒŒì¼ filenameì„ í˜„ì¬ í”„ë¡œì„¸ìŠ¤ì˜ í™˜ê²½ë³€ìˆ˜ë¥¼ ì´ìš©í•˜ë©´ì„œ argvë¡œ í˜„ì¬ì˜ code, data, stackì„ ë®ì–´ ì”Œì›€</p>
</li>
<li>
<p>example</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span style=color:#66d9ef>if</span> ((pid <span style=color:#f92672>=</span> fork()) <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>) {
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span>  <span style=color:#66d9ef>if</span> (execve(myargv[<span style=color:#ae81ff>0</span>], myargv, environ) <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0</span>) {
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span>    printf(<span style=color:#e6db74>&#34;%s: Command not found.</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>, myargv[<span style=color:#ae81ff>0</span>]);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span>    exit(<span style=color:#ae81ff>1</span>);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span>  }
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span>}
</code></pre></div></li>
</ul>
<h3 id=shell>shell</h3>
<blockquote>
<p>ì‚¬ìš©ìì˜ ëª…ë ¹ì„ ì²˜ë¦¬í•´ì£¼ëŠ” ì‘ìš© í”„ë¡œê·¸ë¨</p>
</blockquote>
<ul>
<li>Utility : fileë¡œ êµ¬í˜„ëœ ëª…ë ¹ì–´</li>
<li>Built-in : ì½”ë“œë¡œ êµ¬í˜„ëœ ëª…ë ¹ì–´</li>
</ul>
<h3 id=eval>eval</h3>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>eval</span>(<span style=color:#66d9ef>char</span> <span style=color:#f92672>*</span>cmdline) {
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span>  <span style=color:#66d9ef>char</span> <span style=color:#f92672>*</span>argv[MAXARGS];
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span>  <span style=color:#66d9ef>int</span> bg;
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span>  pid_t pid;
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span>  bg <span style=color:#f92672>=</span> parseline(cmdline, argv);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span>  <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span>builtin_command(argv)) {
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span>    <span style=color:#66d9ef>if</span> ((pid <span style=color:#f92672>=</span> fork()) <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>) {
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span>      <span style=color:#66d9ef>if</span> (execve(argv[<span style=color:#ae81ff>0</span>], argv, environ) <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0</span>) {
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span>        printf(<span style=color:#e6db74>&#34;%s: Command not found.</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>, argv[<span style=color:#ae81ff>0</span>]);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span>        exit(<span style=color:#ae81ff>0</span>);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span>      }
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span>    }
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span>    <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span>bg) {
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span>      <span style=color:#66d9ef>int</span> status;
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span>      <span style=color:#66d9ef>if</span> (waitpid(pid, <span style=color:#f92672>&amp;</span>status, <span style=color:#ae81ff>0</span>) <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0</span> )
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span>        unix_error(<span style=color:#e6db74>&#34;waitfg: waitpid error&#34;</span>);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span>    }
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span>    <span style=color:#66d9ef>else</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span>      printf(<span style=color:#e6db74>&#34;%d %s&#34;</span>, pid, cmdline);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span>  }
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span>}
</code></pre></div><p>-> ë°±ê·¸ë¼ìš´ë“œ ì‘ì—…ì´ ì¢…ë£Œë˜ë©´ zombieê°€ ëœë‹¤</p>
<ul>
<li>í•´ê²°ë°©ë²• : <strong>signal</strong></li>
</ul>
<h2 id=11-signal>11-signal</h2>
<h3 id=signal>Signal</h3>
<blockquote>
<p>ì–´ë–¤ ì´ë²¤íŠ¸ê°€ ì‹œìŠ¤í…œì— ë°œìƒí–ˆë‹¤ëŠ” ê²ƒì„ í”„ë¡œì„¸ìŠ¤ì—ê²Œ ì•Œë ¤ì£¼ëŠ” ì§§ì€ ë©”ì‹œì§€</p>
</blockquote>
<h3 id=receiving-a-signal>Receiving a signal</h3>
<blockquote>
<p>ëª©ì ì§€ í”„ë¡œì„¸ìŠ¤ê°€ ì‹œê·¸ë„ì„ ë°›ì„ ë•Œ, ì–´ë–¤ í˜•íƒœë¡œë“  ë°˜ì‘ì„ í•˜ë„ë¡ ì»¤ë„ì— ì˜í•´ ìš”êµ¬ë ë•Œ, ì‹œê·¸ë„ì„ ë°›ëŠ”ë‹¤ê³  í•œë‹¤.</p>
</blockquote>
<ul>
<li>3ê°€ì§€ ë°˜ì‘
<ul>
<li>ë¬´ì‹œ</li>
<li>ëŒ€ìƒ í”„ë¡œì„¸ìŠ¤ë¥¼ ì¢…ë£Œ</li>
<li><strong>signal handler</strong>ë¼ê³  ë¶€ë¥´ëŠ” ìœ ì €ë ˆë²¨ í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•˜ì—¬ ì‹œê·¸ë„ì„ ì¡ëŠ”ë‹¤</li>
</ul>
</li>
</ul>
<h3 id=ì‹œê·¸ë„ì˜-íŠ¹ì§•>ì‹œê·¸ë„ì˜ íŠ¹ì§•</h3>
<ul>
<li>í”„ë¡œì„¸ìŠ¤ëŠ” íŠ¹ì • ì‹œê·¸ë„ì˜ ìˆ˜ì‹ ì„ ë¸”ë¡í•  ìˆ˜ ìˆë‹¤.</li>
<li>ëŒ€ê¸°í•˜ëŠ” ì‹œê·¸ë„ì€ ìµœëŒ€ í•œë²ˆë§Œ ìˆ˜ì‹ í•  ìˆ˜ ìˆë‹¤.</li>
<li>ì»¤ë„ì´ contextì— ê°€ì§€ê³  ìˆëŠ” ë¹„íŠ¸ë²¡í„°
<ul>
<li>pending : ëŒ€ê¸° ì‹œê·¸ë„ë“¤ì„ í‘œì‹œ
<ul>
<li>ë„ì°©í• ë•Œë§ˆë‹¤ pendingê°’ì˜ kë²ˆì§¸ ë¹„íŠ¸ë¥¼ 1ë¡œ ì„¤ì •</li>
<li>ìˆ˜ì‹ í• ë•Œë§ˆë‹¤ pendingê°’ì˜ kë²ˆì§¸ ë¹„íŠ¸ë¥¼ 0ìœ¼ë¡œ ì„¤ì •</li>
</ul>
</li>
<li>blocked : ë¸”ë¡ëœ ì‹œê·¸ë„ë“¤ì„ í‘œì‹œ
<ul>
<li>sigprocmask í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ì‘ìš©í”„ë¡œê·¸ë¨ì´ 1ë˜ëŠ” 0ë¡œ ì„¤ì •</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id=í”„ë¡œì„¸ìŠ¤-ê·¸ë£¹>í”„ë¡œì„¸ìŠ¤ ê·¸ë£¹</h3>
<ul>
<li>ê° í”„ë¡œì„¸ìŠ¤ëŠ” í•˜ë‚˜ì˜ í”„ë¡œì„¸ìŠ¤ ê·¸ë£¹ì— ì†í•œë‹¤</li>
<li>ê¸°ë³¸ì ìœ¼ë¡œ ìì‹ì€ ë¶€ëª¨ì™€ ê°™ì€ ê·¸ë£¹ì— ì†í•œë‹¤</li>
<li>ì‰˜ì€ ê° jobë§ˆë‹¤ ë³„ë„ì˜ í”„ë¡œì„¸ìŠ¤ ê·¸ë£¹ì„ ë§Œë“ ë‹¤</li>
<li>getpgrp() : í”„ë¡œì„¸ìŠ¤ì˜ í”„ë¡œì„¸ìŠ¤ ê·¸ë£¹ì„ ë¦¬í„´</li>
<li>setpgid() : í”„ë¡œì„¸ìŠ¤ì˜ ê·¸ë£¹ì„ ë³€ê²½</li>
</ul>
<h3 id=kill>kill</h3>
<ul>
<li>kill -9 24818 : SIGKILLì„ pid 24818ë¡œ ë³´ëƒ„</li>
<li>kill -9 -24817 : pgid 24871ì˜ ê° í”„ë¡œì„¸ìŠ¤ì— SIGKILLì„ ë³´ëƒ„</li>
</ul>
<h3 id=í‚¤ë³´ë“œë¡œë¶€í„°-ì‹œê·¸ë„-ë³´ë‚´ê¸°>í‚¤ë³´ë“œë¡œë¶€í„° ì‹œê·¸ë„ ë³´ë‚´ê¸°</h3>
<ul>
<li>í‚¤ë³´ë“œë¡œ ctrl+c (ctrl+z)ë¥¼ ëˆ„ë¥´ë©´ SIGINT(SIGTSTP) ì‹œê·¸ë„ì´ í¬ê·¸ë¼ìš´ë“œ í”„ë¡œì„¸ìŠ¤ ê·¸ë£¹ì˜ ëª¨ë“  ì‘ì—…ìœ¼ë¡œ ì „ì†¡ëœë‹¤</li>
<li>SIGINT : ê° í”„ë¡œì„¸ìŠ¤ë¥¼ ëª¨ë‘ ì¢…ë£Œì‹œí‚¨ë‹¤.</li>
<li>SIGTSTP : ê¸°ë³¸ ë™ì‘ì€ ê° í”„ë¡œì„¸ìŠ¤ë¥¼ ì •ì§€ì‹œí‚¨ë‹¤.</li>
</ul>
<h3 id=ì‹œê·¸ë„-ë°›ê¸°>ì‹œê·¸ë„ ë°›ê¸°</h3>
<ul>
<li>ì»¤ë„ì€ pnb = pending & ~blocked ë¥¼ ê³„ì‚°</li>
<li>ê° ì‹œê·¸ë„ íƒ€ì…ì€ ì‚¬ì „ì— ì •ì˜ëœ ê¸°ë³¸ ë™ì‘ì„ ê°€ì§„ë‹¤.</li>
<li>ê¸°ë³¸ ë™ì‘ì€ signalí•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì—¬ ë³€ê²½ì´ ê°€ëŠ¥í•œë‹¤
<strong>(SIGSTOPê³¼ SIGKILLì€ ì˜ˆì™¸)</strong></li>
</ul>
<h3 id=ì‹œê·¸ë„-í•¸ë“¤ëŸ¬ì˜-ì„¤ì¹˜>ì‹œê·¸ë„ í•¸ë“¤ëŸ¬ì˜ ì„¤ì¹˜</h3>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span>handler_t <span style=color:#f92672>*</span>signal(<span style=color:#66d9ef>int</span> signum, handler_t <span style=color:#f92672>*</span>handler)
</code></pre></div><ul>
<li>handlerì˜ ê°’
<ul>
<li>SIG_IGN : signum íƒ€ì… ì‹œê·¸ë„ ë¬´ì‹œ</li>
<li>SIG_DFL : signumì˜ ê¸°ë³¸ë™ì‘ìœ¼ë¡œ ë³µê·€</li>
<li>ì´ì™¸ì˜ ê²½ìš° : signal handlerì˜ ì£¼ì†Œ</li>
</ul>
</li>
</ul>
<h3 id=ì‹œê·¸ë„-ë¸”ë¡í•˜ê¸°ì™€-í•´ì œí•˜ê¸°>ì‹œê·¸ë„ ë¸”ë¡í•˜ê¸°ì™€ í•´ì œí•˜ê¸°</h3>
<ul>
<li>
<p>sigprocmask ì´ìš©</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>sigprocmask</span>(<span style=color:#66d9ef>int</span> how, <span style=color:#66d9ef>const</span> sigset_t <span style=color:#f92672>*</span>set, sigset_t <span style=color:#f92672>*</span>oldest);
</code></pre></div></li>
<li>
<p>howê°’ì— ë”°ë¼ ë™ì‘ì´ ê²°ì •ëœë‹¤</p>
<ul>
<li>SIG_BLOCK : blocked = (blocked | set)</li>
<li>SIG_UNBLOCK : blocked = blocked & ~set</li>
<li>SIG_SETMASK : blocked = set</li>
</ul>
</li>
<li>
<p>set ê´€ë ¨ ì§€ì› í•¨ìˆ˜</p>
<ul>
<li>sigemptyset : ëª¨ë“  ì‹œê·¸ë„ì´ ë¹„ì–´ìˆëŠ” ì§‘í•© ìƒì„±</li>
<li>sigfillset : ëª¨ë“  ì‹œê·¸ë„ ë²ˆí˜¸ë¥¼ 1ë¡œ ì„¤ì •</li>
<li>sigaddset : íŠ¹ì • ì‹œê·¸ë„ ë²ˆí˜¸ë¥¼ 1ë¡œ ì„¤ì •</li>
<li>sigdelset : íŠ¹ì • ì‹œê·¸ë„ ë²ˆí˜¸ë¥¼ 0ìœ¼ë¡œ ì„¤ì •</li>
</ul>
</li>
</ul>
<h3 id=ê²½ì£¼-race-í˜„ìƒìœ¼ë¡œ-ì¸í•œ-ë™ê¸°í™”ì˜-ë¬¸ì œ>ê²½ì£¼ Race í˜„ìƒìœ¼ë¡œ ì¸í•œ ë™ê¸°í™”ì˜ ë¬¸ì œ</h3>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>handler</span>(<span style=color:#66d9ef>int</span> sig) {
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span>  <span style=color:#66d9ef>int</span> olderrno <span style=color:#f92672>=</span> errno;
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span>  sigset_t mask_all, prev_all;
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span>  pid_t pid;
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span>  sigfillset(<span style=color:#f92672>&amp;</span>mask_all);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span>  <span style=color:#66d9ef>while</span> ((pid <span style=color:#f92672>=</span> waitpid(<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, NULL, <span style=color:#ae81ff>0</span>)) <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span> ) {
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span>    sigprocmask(SIG_BLOCK, <span style=color:#f92672>&amp;</span>mask_all, <span style=color:#f92672>&amp;</span>prev_all);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span>    deletejob(pid);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span>    sigprocmask(SIG_SETMASK, <span style=color:#f92672>&amp;</span>prev_all, NULL);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span>  }
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span>  <span style=color:#66d9ef>if</span> (errno <span style=color:#f92672>!=</span> ECHILD)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span>    sio_error(<span style=color:#e6db74>&#34;waitpid error&#34;</span>);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span>  errno <span style=color:#f92672>=</span> olderno;
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span>}
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>(<span style=color:#66d9ef>int</span> argc, <span style=color:#66d9ef>char</span> <span style=color:#f92672>**</span>argv) {
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span>  <span style=color:#66d9ef>int</span> pid;
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span>  sigset_t mask_all, prev_all;
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span>  <span style=color:#66d9ef>int</span> n <span style=color:#f92672>=</span> N; <span style=color:#75715e>// N = 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span style=color:#75715e></span>  sigfillset(<span style=color:#f92672>&amp;</span>mask_all);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span>  signal(SIGCHLD, handler);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span>  initjobs();
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span>  <span style=color:#66d9ef>while</span> (n<span style=color:#f92672>--</span>) {
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span>    <span style=color:#66d9ef>if</span> ((pid <span style=color:#f92672>=</span> fork()) <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>) {
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27</span>      execve(<span style=color:#e6db74>&#34;/bin/date&#34;</span>, argv, NULL);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28</span>    }
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">29</span>    <span style=color:#75715e>// !! ì—¬ê¸°ì„œ SIGCHLDê°€ ë°œìƒí•˜ë©´ ì˜¤ë¥˜
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">30</span><span style=color:#75715e></span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">31</span>    <span style=color:#75715e>// í•¸ë“¤ëŸ¬ì—ì„œ jobì„ accessí•˜ì§€ ëª»í•˜ë„ë¡ ëª¨ë“  signal block
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">32</span><span style=color:#75715e></span>    sigprocmask(SIG_BLOCK, <span style=color:#f92672>&amp;</span>mask_all, <span style=color:#f92672>&amp;</span>prev_all)<span style=color:#960050;background-color:#1e0010>ë¥˜</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">33</span>    addjob(pid);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">34</span>    sigprocmask(SIG_SETMASK, <span style=color:#f92672>&amp;</span>prev_all, NULL);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">35</span>  }
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">36</span>  exit(<span style=color:#ae81ff>0</span>);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">37</span>}
</code></pre></div><ul>
<li>ë¶€ëª¨ê°€ ë¨¼ì € SIGCHLD ì‹œê·¸ë„ì´ í„°ì§€ê¸° ì „ì— SIG_BLOCKí•˜ê³  addjobì„ í•˜ëŠ” ê²½ìš° -> OK</li>
<li>ë¶€ëª¨ê°€ SIG_BLOCKí•˜ê¸° ì „ì— ìì‹ì´ ëë‚˜ëŠ” ê²½ìš° handlerê°€ ë¨¼ì € ì‹¤í–‰ëœë‹¤ addjobí•˜ê¸°ì „ì— deletejob ìˆ˜í–‰
<ul>
<li>ë¬´í•œ ë£¨í”„ ë°œìƒ</li>
</ul>
</li>
</ul>
<h3 id=ê²½ì£¼í˜„ìƒì„-íšŒí”¼í•˜ëŠ”-ë™ê¸°í™”-ë°©ë²•>ê²½ì£¼í˜„ìƒì„ íšŒí”¼í•˜ëŠ” ë™ê¸°í™” ë°©ë²•</h3>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>(<span style=color:#66d9ef>int</span> argc, <span style=color:#66d9ef>char</span> <span style=color:#f92672>**</span>argv) {
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span>  <span style=color:#66d9ef>int</span> pid;
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span>  sigset_t mask_all, mask_one, prev_one;
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span>  <span style=color:#66d9ef>int</span> n <span style=color:#f92672>=</span> N; <span style=color:#75715e>// N = 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span style=color:#75715e></span>  sigfillset(<span style=color:#f92672>&amp;</span>mask_all);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span>  sigemptyset(<span style=color:#f92672>&amp;</span>mask_one);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span>  sigaddset(<span style=color:#f92672>&amp;</span>mask_one, SIGCHLD);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span>  signal(SIGCHLD, handler);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span>  initjobs();
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span>  <span style=color:#66d9ef>while</span> (n<span style=color:#f92672>--</span>) {
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span>    sigprocmask(SIG_BLOCK, <span style=color:#f92672>&amp;</span>mask_one, <span style=color:#f92672>&amp;</span>prev_one); <span style=color:#75715e>// block SIGCHILD
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span style=color:#75715e></span>    <span style=color:#66d9ef>if</span> ((pid <span style=color:#f92672>=</span> fork()) <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>) {
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span>      <span style=color:#75715e>// ìì‹ì€ SIGCHLDë¥¼ blockí•  í•„ìš”ê°€ ì—†ìœ¼ë¯€ë¡œ ë‹¤ì‹œ unblock
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span style=color:#75715e></span>      sigprocmask(SIG_SETMASK, <span style=color:#f92672>&amp;</span>prev_one, NULL); <span style=color:#75715e>// unblock SIGCHLD
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span style=color:#75715e></span>      execve(<span style=color:#e6db74>&#34;/bin/date&#34;</span>, argv, NULL);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span>    }
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span>    sigprocmask(SIG_BLOCK, <span style=color:#f92672>&amp;</span>mask_all, NULL);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span>    addjob(pid);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span>    sigprocmask(SIG_SETMASK, <span style=color:#f92672>&amp;</span>prev_one, NULL);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span>  }
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span>  exit(<span style=color:#ae81ff>0</span>);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span>}
</code></pre></div><ul>
<li>ë¶€ëª¨ì…ì¥ì—ì„œ forkê°€ ì‹¤í–‰ë˜ê³  ë‚˜ì„œ SIGCHLDê°€ unblock ë˜ëŠ” ìˆœê°„ì´ ë‹¨ í•œë²ˆë„ ì¡´ì¬ í•˜ì§€ ì•ŠìŒ.</li>
<li>í•­ìƒ addjobì´ ë¨¼ì € ì‹¤í–‰ë¨ -> ì˜¤ë¥˜ X</li>
</ul>
<h3 id=ëª…ì‹œì ìœ¼ë¡œ-í•¸ë“¤ëŸ¬ë¥¼-ê¸°ë‹¤ë¦¬ëŠ”-ë°©ì‹>ëª…ì‹œì ìœ¼ë¡œ í•¸ë“¤ëŸ¬ë¥¼ ê¸°ë‹¤ë¦¬ëŠ” ë°©ì‹</h3>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span style=color:#66d9ef>volatile</span> sig_atomic_t pid; <span style=color:#75715e>// pidëŠ” ì „ì—­ë³€ìˆ˜ë¡œ ì„ ì–¸
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span style=color:#75715e></span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>sigchld_handler</span>(<span style=color:#66d9ef>int</span> s) {
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span>  <span style=color:#66d9ef>int</span> orderrno <span style=color:#f92672>=</span> errno;
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span>  <span style=color:#75715e>// sigchld_handlerì—ì„œ waitpid í•˜ëŠ” ë°©ì‹
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span style=color:#75715e></span>  pid <span style=color:#f92672>=</span> waitpid(<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, NULL, <span style=color:#ae81ff>0</span>);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span>  errno <span style=color:#f92672>=</span> olderrno;
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span>}
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>sigint_handler</span>(<span style=color:#66d9ef>int</span> s) {}
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>(<span style=color:#66d9ef>int</span> argc, <span style=color:#66d9ef>char</span> <span style=color:#f92672>**</span>argv) {
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span>  sigset_t mask, prev;
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span>  <span style=color:#66d9ef>int</span> n <span style=color:#f92672>=</span> N; <span style=color:#75715e>// N = 10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span style=color:#75715e></span>  signal(SIGCHLD, sigchld_handler);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span>  signal(SIGINT, sigint_handler);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span>  sigemptyset(<span style=color:#f92672>&amp;</span>mask);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span>  sigaddset(<span style=color:#f92672>&amp;</span>mask, SIGCHLD);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span>  <span style=color:#66d9ef>while</span> (n<span style=color:#f92672>--</span>) {
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span>    sigprocmask(SIG_BLOCK, <span style=color:#f92672>&amp;</span>mask, <span style=color:#f92672>&amp;</span>prev); <span style=color:#75715e>// block SIGCHILD
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span style=color:#75715e></span>    <span style=color:#66d9ef>if</span> (fork() <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span>      exit(<span style=color:#ae81ff>0</span>);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span>    pid <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span>    sigprocmask(SIG_SETMASK, <span style=color:#f92672>&amp;</span>prev, NULL);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span>    <span style=color:#75715e>// Wait for SIGCHLD to be recieved
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27</span><span style=color:#75715e></span>    <span style=color:#66d9ef>while</span> (<span style=color:#f92672>!</span>pid)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28</span>      ;
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">29</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">30</span>    <span style=color:#75715e>// Do some work after receiving SIGCHLD
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">31</span><span style=color:#75715e></span>    printf(<span style=color:#e6db74>&#34;.&#34;</span>);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">32</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">33</span>  printf(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">34</span>  exit(<span style=color:#ae81ff>0</span>);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">35</span>}
</code></pre></div><ul>
<li>
<p>sigsuspendë¥¼ ì‚¬ìš©í•œ ì‹œê·¸ë„ ë™ê¸°í™”</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>sigsuspend</span>(<span style=color:#66d9ef>const</span> sigset_t <span style=color:#f92672>*</span>mask);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span style=color:#75715e>// ì•„ë˜ì˜ ì½”ë“œë¥¼ êµ¬í˜„í•œ ê²ƒê³¼ ë™ì¼
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span style=color:#75715e></span>sigprocmask(SIG_SETMASK, <span style=color:#f92672>&amp;</span>mask, <span style=color:#f92672>&amp;</span>prev);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span>pause();
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span>sigprocmask(SIG_SETMASK, <span style=color:#f92672>&amp;</span>prev, NULL);
</code></pre></div></li>
<li>
<p>sigsuspendë¥¼ ì´ìš©í•œ ì‹œê·¸ë„ ê¸°ë‹¤ë¦¬ê¸°</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>(<span style=color:#66d9ef>int</span> argc, <span style=color:#66d9ef>char</span> <span style=color:#f92672>**</span>argv) {
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span>sigset_t mask, prev;
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span style=color:#66d9ef>int</span> n <span style=color:#f92672>=</span> N; <span style=color:#75715e>// N = 10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span style=color:#75715e></span>signal(SIGCHLD, sigchld_handler);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span>signal(SIGINT, sigint_handler);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span>sigemptyset(<span style=color:#f92672>&amp;</span>mask);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span>sigaddset(<span style=color:#f92672>&amp;</span>mask, SIGCHLD);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span style=color:#66d9ef>while</span> (n<span style=color:#f92672>--</span>) {
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span>  sigprocmask(SIG_BLOCK, <span style=color:#f92672>&amp;</span>mask, <span style=color:#f92672>&amp;</span>prev); <span style=color:#75715e>// block SIGCHILD
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span style=color:#75715e></span>  <span style=color:#66d9ef>if</span> (fork() <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span>    exit(<span style=color:#ae81ff>0</span>);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span>  pid <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span>  <span style=color:#75715e>// Wait for SIGCHLD to be recieved
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span style=color:#75715e></span>  <span style=color:#66d9ef>while</span> (<span style=color:#f92672>!</span>pid)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span>    sigsuspend(<span style=color:#f92672>&amp;</span>prev);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span>  <span style=color:#75715e>// Optionally unblock SIGCHILD
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span style=color:#75715e></span>  sigprocmask(SIG_SETMASK, <span style=color:#f92672>&amp;</span>prev, NULL);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span>  <span style=color:#75715e>// Do some work after receiving SIGCHLD
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span style=color:#75715e></span>  printf(<span style=color:#e6db74>&#34;.&#34;</span>);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span>}
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span>printf(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span>exit(<span style=color:#ae81ff>0</span>);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27</span>}
</code></pre></div></li>
</ul>
</article>
<div id=" meta" class=my-16>
<div>
<div class="flex justify-between w-full text-lg">
<a class="previous mr-5 overflow-ellipsis-bundle hover-bold" href=/til/school/sysp_12_13/>
<span class=mx-3>â—€</span>
221208 SYSP
</a>
<a class="next ml-5 overflow-ellipsis-bundle hover-bold" href=/til/school/%EC%BF%A0%EB%B2%84%EB%84%A4%ED%8B%B0%EC%8A%A4-%EB%B0%8F-msa-%ED%8A%B9%EA%B0%95-1%EC%9D%BC%EC%B0%A8/>
ì¿ ë²„ë„¤í‹°ìŠ¤ ë° MSA íŠ¹ê°• 1ì¼ì°¨ : í´ë¼ìš°ë“œ ì»´í“¨íŒ… ê°œë… ë° ì—­ì‚¬
<span class=mx-3>â–¶</span>
</a>
</div>
</div>
</div>
<div id=comment-box></div>
</section>
</main>
</div>
</body>
</html>